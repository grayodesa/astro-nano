---
date: "2025-05-06T11:50:35"
draft: false
url: "/5891"
source: "https://github.com/grayodesa/tg-bot-ero"
images:
    -
forwarded_from: ""
---

Я уже несколько раз в разных местах рассказывал про небольшого антиспам-бота, который написал, чтобы поддерживать порядок в комментариях (уточню, что "написал" — то есть придумал, посоветовался с AI, описал задачу, чтобы AI написал документацию, описал, что по ней надо написать, AI написал код, другой AI сделал ревью, еще один написал по ревью план релиза и так далее). 

Вообще, для основного потока спама есть прекрасное решение tg-spam от Umputun, но, как заметили постоянные комментаторы, он не отлавливает распространенный вид спама — когда от имени аккаунта с сексуальным аватаром оставляется короткий и совершенно не рекламный комментарий в расчете на клик в профиль и переход по ссылке. Я терпел долго, но вручную прибивать этих ботов скучно, пусть другой бот работает.

В общем, что делает написанный "нами" бот? Он проверяет аватар нового комментатора с помощью очень компактной модели NudeNet и выдает вердикт — NSFW/Suspicious/Safe. Еще он проверяет наличие ссылки в bio профиля. Если аватар unsafe, аккаунт блокируется, комментарий удаляется. Если он suspicious и/или есть ссылка и так далее — отправляется запрос в gpt для оценки по нескольким критериям (уменьшительное женское имя в профиле, зазывной текст в bio, бессмысленный сам по себе комментарий и т.д.) и, если gpt считает, что это спам, аккаунт блокируется, комментарий удаляется. 

Полной гарантии все равно нет, но за последние несколько дней удалено два десятка комментариев, причем половина — с достаточно приличным аватаром, но полной бессмыслицей во всем остальном. Я вот жду, когда бот прихлопнет какого-нибудь достигатора — это будет приятный эффект.

Да, а посмотреть на код можно на гитхабе. Там не очень внятно описаны детали деплоя, кажется, но, если кто захочет себе прикрутить, я это дело дошлифую.
