---
date: "2021-08-19T08:55:51"
draft: False
url: /2492
source: "https://www.theverge.com/2021/8/18/22630439/apple-csam-neuralhash-collision-vulnerability-flaw-cryptography"
---

Специалисты по безопасности продолжают изучать предложения Apple по сканированию пользовательского контента и доизучались до создания коллизии в NeuralHash — алгоритма Apple по созданию уникального хеша (точнее говоря, шингла) для фотографий, который затем сравнивается с базой известных образцов нелегального контента.

Коллизия заключается в возможности создать изображение, шингл которого будет идентичен известному, при том, что само изображение будет сильно отличаться от него. Такого результата добился один из пользователей Github, который использовал версию алгоритма на Python, которая, по его словам, является результатом reverse-engineering-а исходного алгоритма, обнаруженного в iOS.

Apple прокомментировала журналистам, что система разрабатывалась с учетом возможности коллизий — кстати, по идее, она должна использовать нечеткие шинглы (то есть совпадающие не полностью), и в таком случае коллизии совершенно неизбежны. Для того, чтобы проконтролировать false positive случаи, компания планирует использование второго алгоритма хеширования на серверах, детали работы которого не раскрываются и который будет запускаться только на позитивных результатах NeuralHash. Если результаты обоих алгоритмов совпадут, случай будет передан модераторам-людям.

Сложно понять, как использовать такую коллизию — если в случае обнаружения в алгоритме шифрования возможности генерации одинаковых хешей для разных наборов данных вектор атаки понятен, то в данном случае потребуется сначала обзавестись известным образцом нелегального контента, сгенерировать несколько десятков совпадающих по хешам картинок и затем как-то запихать их на смартфон жертвы — чтобы в итоге при ручной проверке срабатывания было выявлено false positive. 

UPDATE: Да, и Apple утверждает, что конкретно эта уязвимость была только в исходной версии и давно исправлена.
